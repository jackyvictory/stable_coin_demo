# 实施计划

- [x] 1. 创建项目基础结构和 Docker 配置
  - 在 demo 目录中创建完整的项目文件结构
  - 创建 Dockerfile 和 docker-compose.yml 配置文件
  - 创建 nginx.conf 配置文件，优化静态文件服务
  - 设置基本的项目配置文件 config.js
  - _需求: 5.1, 5.2_

- [x] 2. 复刻首页 (商品选购页面)
  - 基于爬取的 imsafu/imsafu/pages/index.html 创建 demo/index.html
  - 复制并修改相关 CSS 样式文件，替换 imsafu 品牌为 EVO Payment
  - 替换所有 imsafu 标志为 demo/images/logo.png
  - 确保商品选项 (Peanut $0.25, Rice $0.50 等) 正确显示
  - 将 "Pay With imsafu" 按钮替换为 "Pay With EVO Payment"
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

- [x] 3. 复刻收银台页面 (支付方式选择)
  - 基于爬取的 imsafu/imsafu/pages/payment_qrcode.html 创建 demo/payment.html
  - 实现 "Select Payment" 下拉框，包含 USDT, USDC, BUSD 选项
  - 实现 "Select Network" 下拉框，包含 BNB Smart Chain 选项
  - 创建下拉框点击后的模态框/弹窗功能
  - 确保所有品牌元素使用 EVO Payment
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4. 复刻二维码支付页面
  - 创建 demo/qrcode.html，在用户选择支付方式和网络后显示
  - 显示固定的二维码图片 demo/images/wallet_qr.jpg
  - 显示支付详情，包括金额和选择的加密货币信息
  - 添加英文支付说明和指导文字
  - 确保页面使用 EVO Payment 品牌元素
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 5. 集成 Web3.js 和区块链配置
  - 下载并集成 Web3.js 库到 demo/lib/web3.min.js
  - 配置 BNB Smart Chain 主网连接 (RPC: https://bsc-dataseed1.binance.org/)
  - 设置代币合约地址配置 (USDT, USDC, BUSD)
  - 配置固定收款地址 0xe27577B0e3920cE35f100f66430de0108cb78a04
  - 创建基础的区块链连接和查询功能
  - _需求: 4.1, 4.2_

- [x] 6. 实现区块链交易监听功能
  - 创建 BlockchainMonitor 类在 demo/js/blockchain.js
  - 实现轮询方式监听指定地址的代币转账交易
  - 验证交易金额、接收地址和代币合约的正确性
  - 在检测到匹配的支付后触发支付确认事件
  - 添加交易确认的错误处理和超时机制
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [x] 7. 实现支付流程和状态管理
  - 创建 PaymentHandler 类在 demo/js/payment.js
  - 实现支付会话的创建、更新和查询功能
  - 管理支付状态转换 (pending -> waiting -> monitoring -> confirmed -> completed)
  - 实现页面间的导航逻辑 (首页 -> 收银台 -> 二维码 -> 成功页面)
  - 添加支付超时和失败处理逻辑
  - _需求: 4.3, 4.4, 4.5_

- [x] 8. 实现用户界面交互功能
  - 创建 PaymentUI 类在 demo/js/ui.js
  - 实现商品选择和支付按钮的点击事件处理
  - 实现收银台页面的下拉框交互和模态框显示
  - 实现二维码页面的实时状态更新和进度显示
  - 添加用户友好的加载指示器和状态提示
  - _需求: 4.4, 5.3, 5.4, 5.5_

- [x] 9. 创建支付成功页面和自动跳转
  - 创建 demo/success.html 支付成功页面
  - 实现从二维码页面到成功页面的自动跳转逻辑
  - 显示支付成功信息和交易详情
  - 确保成功页面使用 EVO Payment 品牌
  - 添加返回首页或继续购买的功能
  - _需求: 4.3, 4.4_

- [ ] 10. 优化桌面端设计和布局
  - 确保所有页面在桌面浏览器中的最佳视觉效果
  - 优化页面布局和元素间距，保持与原网站的像素级一致
  - 测试不同桌面浏览器 (Chrome, Safari) 的兼容性
  - 确保鼠标交互和悬停效果正常工作
  - 优化二维码在桌面端的显示效果
  - _需求: 5.2_

- [ ] 11. 添加错误处理和用户提示
  - 实现 ErrorHandler 类处理各种错误情况
  - 添加网络连接失败的错误提示 (英文)
  - 添加支付超时和失败的错误处理
  - 实现用户友好的错误信息显示
  - 添加页面加载状态和网络状态指示器
  - _需求: 4.5, 5.4, 5.5_

- [ ] 12. Docker 容器化和部署配置
  - 测试 Docker 镜像构建和容器运行
  - 验证 Nginx 配置和静态文件服务
  - 测试 Docker Compose 编排配置
  - 配置生产环境的 HTTPS 支持
  - 创建部署文档和运行说明
  - _需求: 5.1, 5.2_

- [ ] 13. 集成测试和功能验证
  - 测试完整的支付流程：首页 -> 收银台 -> 二维码 -> 成功页面
  - 在 BSC 主网上测试交易监听功能 (使用小额测试)
  - 验证不同代币 (USDT, USDC, BUSD) 的支付监听
  - 测试页面刷新和状态重置的正确性
  - 验证所有品牌替换的完整性和准确性
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1, 2.2, 2.3, 2.4, 2.5, 3.1, 3.2, 3.3, 3.4, 3.5, 4.1, 4.2, 4.3, 4.4, 4.5_