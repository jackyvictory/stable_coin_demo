(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4049],{34463:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var i=n(96557),s=n(14891),l=n(84318),a=n(98168),o=n(40330),r=n(19862),d=n(44222),u=n(1829),c=n(23961),p=n(27378),m=n(54651),v=n(8888),y=n(87992),g=n(68130),f=n(88779),h=n(84075),x=n(69802),b=n(49078),Z=n(53842),k=n(39983),D=n(59213),T=n(43659),C=n(86677),w=n(87800),P=(0,T.Pi)(function(){var e,t,n,T,P,R,S,E,I,O,_,A,L,M,N,B,X,q,z,F,j=(0,C.useRouter)(),H=j.query,J=j.isReady,U=j.push,W=j.locale,Q=j.pathname,G=j.asPath,K=(0,r.q2)(),V=(0,m.q)(),Y=V.isOpen,$=V.onOpen,ee=V.onClose,et=(0,m.q)(),en=et.isOpen,ei=et.onOpen,es=et.onClose,el=(0,u.oR)(),ea=el.ui,eo=el.paymentDeposit,er=(0,r.NJ)();(0,p.useEffect)(function(){er&&er!=W&&J&&H.payID&&U({pathname:Q,query:H},G,{locale:er})},[J,H.payID]);var ed=eo.payment,eu=eo.tokensBySymbol,ec=eo.payToken,ep=eo.payChain,em=eo.chainsByTokenSymbol,ev=eo.depositAddress,ey=eo.validDeposits,eg=eo.receiveTx,ef=null!==(e=null===(t=H.brand)||void 0===t?void 0:t.toString())&&void 0!==e?e:"",eh=null!==(n=null===(T=H.memo)||void 0===T?void 0:T.toString())&&void 0!==n?n:"",ex=null!==(P=null===(R=H.redirect_url)||void 0===R?void 0:R.toString())&&void 0!==P?P:"",eb=null!==(S=null===(E=H.currency)||void 0===E?void 0:E.toString())&&void 0!==S?S:"",eZ=null!==(I=null==ed?void 0:null===(O=ed.payment)||void 0===O?void 0:O.originalAmount)&&void 0!==I?I:"",ek=null!==(_=null==ed?void 0:null===(A=ed.payment)||void 0===A?void 0:A.payID)&&void 0!==_?_:"",eD=null!==(L=null==ed?void 0:null===(M=ed.payment)||void 0===M?void 0:M.amount)&&void 0!==L?L:"",eT=(null==ed?void 0:ed.status)==="success",eC=(null==ed?void 0:ed.status)==="confirming",ew=null!==(N=null==eg?void 0:eg.txID)&&void 0!==N?N:"",eP=!ea.payment.firstLoad,eR=!ek||(null==ed?void 0:ed.status)==="expired";(0,p.useEffect)(function(){return J&&H.payID&&eo.fetchPaymentDeposit(H.payID.toString()),function(){eo.reset(),ea.resetPaymentRelated()}},[J,eo,ea,H.payID]),function(e,t){let n=(0,v.W)(e);(0,p.useEffect)(()=>{let e=null,i=()=>n();return null!==t&&(e=window.setInterval(i,t)),()=>{e&&window.clearInterval(e)}},[t,n])}(function(){ek&&(null==ed?void 0:ed.status)!=="success"&&eo.fetchPaymentDeposit(ek)},4e3);var eS=function(){var e=(0,u.oR)(),t=e.ui,n=e.paymentDeposit,i=(0,r.q2)(),s=(0,d.g)(),l=n.payment,a=n.receiveTx,o=n.validDeposits,m=n.invalidDeposits,v=t.payment;if((0,p.useEffect)(function(){t.depositAddress.error&&s({title:i.depositAddressErrorTitle,description:t.depositAddress.error,status:"error"})},[t.depositAddress.error]),!v.firstLoad){if(v.error)return{status:"error",title:i.loadingErrorTitle,message:[v.error,i.loadingErrorMessage]};if(l){var y=n.payToken.label.long,g=o[n.payToken.address];if("success"===l.status){var f="";return+g>0&&(f=(0,r.uR)(i.successfulMessage,[g,y])),{status:"success",title:i.successfulTitle,message:f,txID:null==a?void 0:a.txID}}if(null!=a&&a.txError)return{status:"error",title:i.failedTitle,message:[i.failedMessage,null==a?void 0:a.txError],txID:a.txID};if("expired"===l.status)return{status:"error",title:(0,r.uR)(i.expiredTitle,[new Date(l.payment.deadline).toLocaleDateString()])};if("confirming"===l.status)return{status:"loading",title:i.confirmingTitle,message:[(0,r.uR)(i.confirmingMessage,[l.payment.amount,y])]};if("pending"===l.status&&n.payChain){var h=+g<+l.payment.amount,x=+g-+l.payment.amount>=0,b=Object.keys(m).length>0;if(h){var Z=new c.Z(l.payment.amount).minus(new c.Z(g));return{status:"error",title:i.incompleteTitle,message:[(0,r.uR)(i.incompleteMessage1,[g,y]),(0,r.uR)(i.incompleteMessage2,[Z.decimalPlaces(18).toString(),y])]}}return x?{status:"loading",title:i.loadingTitle,message:[(0,r.uR)(i.loadingMessage1,[g,y]),i.loadingMessage2]}:b?{status:"error",title:i.invalidDepositTitle,message:[i.invalidDepositMessage]}:{status:"error",title:"",message:[(0,r.uR)(i.defaultMessage1,[n.payToken.symbol,n.payChain.symbol]),(0,r.uR)(i.defaultMessage2,[n.payChain.label.long])]}}}}}(),eE=(0,p.useCallback)(function(){if(ek){var e=new URL(ex);e.searchParams.set("payID",ek),e.searchParams.set("brand",ef),e.searchParams.set("memo",eh),e.searchParams.set("currency",eb),U(e.toString())}},[U,ex,ek,ef,eh,eb]),eI=(0,p.useCallback)(function(){eo.setPayChain(void 0)},[eo]),eO=!eT&&!eC&&0===Object.values(ey).length;return(0,w.BX)(y.g,{bg:"grey.90",spacing:4,minH:"100vh",children:[(0,w.tZ)(s.Z,{}),(0,w.BX)(g.Z,{variant:"main",children:[(0,w.tZ)(f.O,{children:(0,w.tZ)(o.oQ,{payID:ek,brandName:ef})}),(0,w.tZ)(h.e,{position:"relative",children:(0,w.BX)(o.bH,{txID:ew,amount:eD,token:ec,message:K.paymentConfirmedMessage,isSuccessful:eT,children:[(0,w.tZ)(x.O,{isLoaded:eP,h:"78px",children:(0,w.tZ)(o.yC,{description:eh,total:eD,paid:eT?0:null!==(B=ey[ec.address])&&void 0!==B?B:0,currency:eb,currencyAmount:eZ})}),(0,w.tZ)(b.x,{size:"xs",mt:4,mb:2,children:K.expirationTimeLabel}),(0,w.tZ)(x.O,{isLoaded:eP,h:"48px",children:(0,w.tZ)(o.ES,{deadline:null==ed?void 0:null===(X=ed.payment)||void 0===X?void 0:X.deadline,expiredText:K.expiredAtContent})}),!ep&&(0,w.BX)(Z.xu,{mt:4,children:[(0,w.tZ)(b.x,{size:"xs",mb:2,children:K.selectPaymentLabel}),(0,w.tZ)(x.O,{isLoaded:eP,h:"48px",children:(0,w.tZ)(o.jA,{readonly:eR||ea.depositAddress.loading,placeholder:"Select Token",selectedText:ec.symbol,iconURL:ec.iconURL,onClick:$})}),(0,w.tZ)(b.x,{size:"xs",mt:4,mb:2,children:K.selectNetworkLabel}),(0,w.tZ)(x.O,{isLoaded:eP,h:"48px",children:(0,w.tZ)(o.jA,{readonly:eR,placeholder:K.selectNetworkPlaceholder,onClick:ei})})]}),ep&&ev&&ed&&(0,w.BX)(y.g,{mt:4,spacing:4,children:[(0,w.tZ)(Z.xu,{bg:"grey.80",borderRadius:"full",px:"2",py:"1",fontSize:"xs",children:K.unavailableETH}),(0,w.tZ)(o.mF,{address:ev}),(0,w.tZ)(o.JJ,{reselectPaymentNetwork:eO?eI:void 0,token:ec,chain:ep})]})]})}),(0,w.tZ)(k.e,{children:(0,w.BX)(y.g,{w:"100%",children:[eS&&(0,w.tZ)(o.p_,{status:null!==(q=null==eS?void 0:eS.status)&&void 0!==q?q:"info",title:null!==(z=null==eS?void 0:eS.title)&&void 0!==z?z:"",message:null!==(F=null==eS?void 0:eS.message)&&void 0!==F?F:""}),eT&&(0,w.tZ)(D.z,{size:"lg",variant:"outline",borderColor:"primary.500",borderWidth:"2px",color:"primary.500",onClick:eE,children:K.backToMerchant})]})})]}),(0,w.tZ)(i.Z,{}),(0,w.tZ)(a.Z,{isOpen:Y,tokens:eu,onClose:ee,onSelected:function(e){return eo.setPayToken(e)}}),(0,w.tZ)(l.Z,{isOpen:en,chains:em[ec.symbol],onClose:es,showFees:!0,feeSymbol:ec.symbol,chainsFees:eo.chainsFees,maxFeeAmount:null==ed?void 0:ed.payment.maxFeeAmount,onSelected:function(e){return eo.setPayChain(e)}})]})})},42189:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/payment_qrcode",function(){return n(34463)}])}},function(e){e.O(0,[1091,3817,4328,2914,23,9774,2888,179],function(){return e(e.s=42189)}),_N_E=e.O()}]);